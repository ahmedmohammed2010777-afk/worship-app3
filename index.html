<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø­Ø±Ø§Ø¨ Ø¹Ø§Ø¦Ù„Ø© Ù…Ø­Ù…Ø¯ 2026 - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø°Ù‡Ø¨ÙŠ Ø§Ù„Ø´Ø§Ù…Ù„</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Reem+Kufi:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #1a4d2e; --gold: #c5a059; --bg: #f9f6f0; }
        body {
            font-family: 'Amiri', serif; background-color: var(--bg);
            background-image: url('https://www.transparenttextures.com/patterns/islamic-art.png');
            margin: 0; padding: 10px; color: #2c3e50;
        }
        .main-container {
            max-width: 800px; margin: auto; background: rgba(255,255,255,0.98);
            border: 3px double var(--gold); border-radius: 20px; padding: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        h1, h2, h3 { font-family: 'Reem Kufi', sans-serif; color: var(--primary); text-align: center; margin: 10px 0; }

        /* Ø§Ù„ØªÙ‚ÙˆÙŠÙ… */
        .header-bar {
            background: var(--primary); color: white; padding: 15px;
            border-radius: 15px; border: 1px solid var(--gold); margin-bottom: 20px; text-align: center;
        }
        input[type="date"] {
            background: var(--gold); border: none; color: white; padding: 8px;
            border-radius: 8px; font-family: 'Amiri'; cursor: pointer; font-size: 1rem;
        }

        /* Ø§Ù„Ù…ØªÙ†Ø§ÙØ³ÙˆÙ† */
        .competitors-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px; margin-bottom: 20px; }
        .comp-card {
            background: white; border: 2px solid var(--gold); border-radius: 15px;
            padding: 12px; transition: 0.3s; cursor: pointer; position: relative;
        }
        .comp-card.active { box-shadow: 0 0 15px var(--gold); transform: scale(1.02); border-width: 3px; background: #fffdf5; }
        .comp-name { font-weight: bold; color: var(--primary); border-bottom: 1px solid var(--gold); margin-bottom: 8px; font-size: 1.1rem; }
        .score { font-size: 1.3rem; color: var(--gold); font-weight: bold; }
        .remaining-list { font-size: 0.8rem; color: #a04040; text-align: right; margin-top: 8px; border-top: 1px dashed #ddd; padding-top: 5px; }

        /* Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ */
        .section-card { background: white; border: 1px solid #ddd; border-radius: 12px; padding: 15px; margin-bottom: 15px; }
        .section-title { color: var(--primary); border-bottom: 2px solid var(--gold); padding-bottom: 5px; margin-bottom: 10px; font-weight: bold; display: flex; align-items: center; gap: 10px; }
        .habit-row { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px dashed #eee; }
        .habit-row:last-child { border-bottom: none; }
        .habit-row a { text-decoration: none; color: var(--primary); font-weight: bold; }
        
        .points-badge { font-size: 0.7rem; background: var(--bg); padding: 2px 5px; border-radius: 4px; color: var(--primary); }

        /* Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© */
        .chat-box { height: 120px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; background: #fff; border-radius: 8px; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="main-container">
    <h1>ğŸ•Œ Ù…Ø­Ø±Ø§Ø¨ Ø¹Ø§Ø¦Ù„Ø© Ù…Ø­Ù…Ø¯</h1>

    <div class="header-bar">
        <div>
            <span>ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®: </span>
            <input type="date" id="date-picker" onchange="updateView()">
        </div>
        <div id="hijri-display" style="margin-top:10px; color: var(--gold); font-weight: bold; font-size: 1.1rem;"></div>
    </div>

    <div class="competitors-grid">
        <div class="comp-card active" id="card-Ù…Ø­Ù…Ø¯" onclick="selectUser('Ù…Ø­Ù…Ø¯')">
            <div class="comp-name">Ø§Ù„Ø£Ø¨ Ù…Ø­Ù…Ø¯</div>
            <div class="score">âœ¨ <span id="score-Ù…Ø­Ù…Ø¯">0</span></div>
            <div class="remaining-list" id="rem-Ù…Ø­Ù…Ø¯"></div>
        </div>
        <div class="comp-card" id="card-Ø´ÙŠÙ…Ø§Ø¡" onclick="selectUser('Ø´ÙŠÙ…Ø§Ø¡')">
            <div class="comp-name">Ø§Ù„Ø£Ù… Ø´ÙŠÙ…Ø§Ø¡</div>
            <div class="score">âœ¨ <span id="score-Ø´ÙŠÙ…Ø§Ø¡">0</span></div>
            <div class="remaining-list" id="rem-Ø´ÙŠÙ…Ø§Ø¡"></div>
        </div>
        <div class="comp-card" id="card-Ø£Ø­Ù…Ø¯" onclick="selectUser('Ø£Ø­Ù…Ø¯')">
            <div class="comp-name">Ø£Ø­Ù…Ø¯</div>
            <div class="score">âœ¨ <span id="score-Ø£Ø­Ù…Ø¯">0</span></div>
            <div class="remaining-list" id="rem-Ø£Ø­Ù…Ø¯"></div>
        </div>
        <div class="comp-card" id="card-ÙŠØ§Ø³ÙŠÙ†" onclick="selectUser('ÙŠØ§Ø³ÙŠÙ†')">
            <div class="comp-name">ÙŠØ§Ø³ÙŠÙ†</div>
            <div class="score">âœ¨ <span id="score-ÙŠØ§Ø³ÙŠÙ†">0</span></div>
            <div class="remaining-list" id="rem-ÙŠØ§Ø³ÙŠÙ†"></div>
        </div>
    </div>

    <h2 id="current-user-title">Ø¬Ø¯ÙˆÙ„ Ø·Ø§Ø¹Ø§Øª: Ù…Ø­Ù…Ø¯</h2>

    <div class="section-card">
        <div class="section-title">ğŸ•‹ Ø§Ù„ÙØ±ÙˆØ¶ Ø§Ù„Ø®Ù…Ø³Ø©</div>
        <div id="list-fard"></div>
    </div>

    <div class="section-card">
        <div class="section-title">âœ¨ Ø§Ù„Ø³Ù†Ù† ÙˆØ§Ù„Ø±ÙˆØ§ØªØ¨ ÙˆØ§Ù„Ù†ÙˆØ§ÙÙ„</div>
        <div id="list-sunan"></div>
    </div>

    <div class="section-card">
        <div class="section-title">ğŸ“– Ø§Ù„Ø£Ø°ÙƒØ§Ø± ÙˆØ§Ù„Ø£ÙˆØ±Ø§Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</div>
        <div id="list-azkar"></div>
    </div>

    <div class="section-card">
        <div class="section-title">ğŸ’¬ Ù…Ù„ØªÙ‚Ù‰ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© (ÙŠØªØ¬Ø¯Ø¯ ÙŠÙˆÙ…ÙŠØ§Ù‹)</div>
        <div id="chat-msgs" class="chat-box"></div>
        <div style="display: flex; gap: 5px;">
            <input type="text" id="chat-input" placeholder="Ø±Ø³Ø§Ù„Ø© Ø¥ÙŠÙ…Ø§Ù†ÙŠØ©..." style="flex:1; padding:8px; border-radius:5px; border:1px solid #ccc;">
            <button onclick="sendMsg()" style="background:var(--primary); color:white; border:none; padding:8px 20px; border-radius:8px; cursor:pointer;">Ø¥Ø±Ø³Ø§Ù„</button>
        </div>
    </div>
</div>

<script>
    let currentUser = 'Ù…Ø­Ù…Ø¯';
    
    const categories = {
        fard: [
            {id: 'fajr', name: 'ØµÙ„Ø§Ø© Ø§Ù„ÙØ¬Ø±', pts: 10},
            {id: 'dhuhr', name: 'ØµÙ„Ø§Ø© Ø§Ù„Ø¸Ù‡Ø±', pts: 10},
            {id: 'asr', name: 'ØµÙ„Ø§Ø© Ø§Ù„Ø¹ØµØ±', pts: 10},
            {id: 'maghrib', name: 'ØµÙ„Ø§Ø© Ø§Ù„Ù…ØºØ±Ø¨', pts: 10},
            {id: 'isha', name: 'ØµÙ„Ø§Ø© Ø§Ù„Ø¹Ø´Ø§Ø¡', pts: 10}
        ],
        sunan: [
            {id: 's_fajr', name: 'Ø³Ù†Ø© Ø§Ù„ÙØ¬Ø± (Ø±ÙƒØ¹ØªØ§Ù† Ù‚Ø¨Ù„ÙŠØ©)', pts: 5},
            {id: 's_dhuhr_b', name: 'Ø³Ù†Ø© Ø§Ù„Ø¸Ù‡Ø± (4 Ø±ÙƒØ¹Ø§Øª Ù‚Ø¨Ù„ÙŠØ©)', pts: 5},
            {id: 's_dhuhr_a', name: 'Ø³Ù†Ø© Ø§Ù„Ø¸Ù‡Ø± (Ø±ÙƒØ¹ØªØ§Ù† Ø¨Ø¹Ø¯ÙŠØ©)', pts: 5},
            {id: 's_maghrib', name: 'Ø³Ù†Ø© Ø§Ù„Ù…ØºØ±Ø¨ (Ø±ÙƒØ¹ØªØ§Ù† Ø¨Ø¹Ø¯ÙŠØ©)', pts: 5},
            {id: 's_isha', name: 'Ø³Ù†Ø© Ø§Ù„Ø¹Ø´Ø§Ø¡ (Ø±ÙƒØ¹ØªØ§Ù† Ø¨Ø¹Ø¯ÙŠØ©)', pts: 5},
            {id: 'duha', name: 'ØµÙ„Ø§Ø© Ø§Ù„Ø¶Ø­Ù‰ (Ù†ÙÙ„)', pts: 7},
            {id: 'witr', name: 'ØµÙ„Ø§Ø© Ø§Ù„Ø´ÙØ¹ ÙˆØ§Ù„ÙˆØªØ±', pts: 7}
        ],
        azkar: [
            {id: 'morn', name: 'Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­', pts: 5, link: 'https://alazkar.today/'},
            {id: 'even', name: 'Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡', pts: 5, link: 'https://alazkar.today/'},
            {id: 'sleep', name: 'Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù†ÙˆÙ…', pts: 5, link: 'https://alazkar.today/'},
            {id: 'mulk', name: 'Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ù„Ùƒ', pts: 10, link: 'https://quran.com/67'},
            {id: 'kahf', name: 'Ø³ÙˆØ±Ø© Ø§Ù„ÙƒÙ‡Ù (ÙŠÙˆÙ… Ø§Ù„Ø¬Ù…Ø¹Ø©)', pts: 15, link: 'https://quran.com/18', friday: true}
        ]
    };

    function updateView() {
        const date = document.getElementById('date-picker').value;
        const hijri = new Intl.DateTimeFormat('ar-SA-u-ca-islamic-uma', {day:'numeric', month:'long', year:'numeric'}).format(new Date(date));
        document.getElementById('hijri-display').innerText = hijri;
        refreshAll();
    }

    function selectUser(user) {
        currentUser = user;
        document.querySelectorAll('.comp-card').forEach(c => c.classList.remove('active'));
        document.getElementById('card-' + user).classList.add('active');
        document.getElementById('current-user-title').innerText = "Ø¬Ø¯ÙˆÙ„ Ø·Ø§Ø¹Ø§Øª: " + user;
        refreshAll();
    }

    function toggleHabit(id) {
        const date = document.getElementById('date-picker').value;
        const key = `v3_${currentUser}_${date}_${id}`;
        const status = localStorage.getItem(key) === 'true';
        localStorage.setItem(key, !status);
        refreshAll();
    }

    function refreshAll() {
        const date = document.getElementById('date-picker').value;
        const isFriday = new Date(date).getDay() === 5;
        const users = ['Ù…Ø­Ù…Ø¯', 'Ø´ÙŠÙ…Ø§Ø¡', 'Ø£Ø­Ù…Ø¯', 'ÙŠØ§Ø³ÙŠÙ†'];

        users.forEach(u => {
            let score = 0;
            let rem = [];
            [...categories.fard, ...categories.sunan, ...categories.azkar].forEach(h => {
                if(h.friday && !isFriday) return;
                const done = localStorage.getItem(`v3_${u}_${date}_${h.id}`) === 'true';
                if(done) score += h.pts; else rem.push(h.name);
            });
            document.getElementById(`score-${u}`).innerText = score;
            document.getElementById(`rem-${u}`).innerHTML = "<b>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:</b> " + (rem.length > 0 ? rem.slice(0,2).join('ØŒ ') + '..' : 'âœ…');
        });

        renderList('list-fard', categories.fard, date);
        renderList('list-sunan', categories.sunan, date);
        renderList('list-azkar', categories.azkar, date, isFriday);
    }

    function renderList(id, items, date, isFriday = true) {
        const container = document.getElementById(id);
        container.innerHTML = items.map(h => {
            if(h.friday && !isFriday) return '';
            const done = localStorage.getItem(`v3_${currentUser}_${date}_${h.id}`) === 'true';
            return `
                <div class="habit-row">
                    ${h.link ? `<a href="${h.link}" target="_blank">ğŸ”— ${h.name}</a>` : `<span>${h.name}</span>`}
                    <div>
                        <span class="points-badge">${h.pts}Ù†</span>
                        <input type="checkbox" ${done ? 'checked' : ''} onchange="toggleHabit('${h.id}')">
                    </div>
                </div>
            `;
        }).join('');
    }

    function manageChat() {
        const today = new Date().toDateString();
        if(localStorage.getItem('chat_v3_date') !== today) {
            localStorage.setItem('chat_v3_log', JSON.stringify([]));
            localStorage.setItem('chat_v3_date', today);
        }
        drawChat();
    }

    function sendMsg() {
        const inp = document.getElementById('chat-input');
        if(!inp.value) return;
        let msgs = JSON.parse(localStorage.getItem('chat_v3_log') || "[]");
        msgs.push({ u: currentUser, t: inp.value, time: new Date().toLocaleTimeString('ar-EG', {hour:'2-digit', minute:'2-digit'}) });
        localStorage.setItem('chat_v3_log', JSON.stringify(msgs));
        inp.value = ""; drawChat();
    }

    function drawChat() {
        const box = document.getElementById('chat-msgs');
        let msgs = JSON.parse(localStorage.getItem('chat_v3_log') || "[]");
        box.innerHTML = msgs.map(m => `<div><small>${m.time}</small> <b>${m.u}:</b> ${m.t}</div>`).join('');
        box.scrollTop = box.scrollHeight;
    }

    window.onload = () => {
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('date-picker').value = today;
        updateView();
        manageChat();
    };
</script>
</body>
</html>
