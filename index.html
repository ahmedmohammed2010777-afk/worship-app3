<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø£Ø³Ø±ØªÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø§Ø¹Ø© - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø´Ø§Ù…Ù„Ø©</title>

<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Changa:wght@400;700&display=swap');
body { font-family:'Changa',sans-serif;background:#e0e5ec;padding:10px;color:#444;min-height:100vh }
.neu-card { background:#e0e5ec; box-shadow:9px 9px 16px #a3b1c6, -9px -9px 16px #fff; border-radius:25px; border: 1px solid rgba(255,255,255,0.3) }
.neu-inset { background:#e0e5ec; box-shadow:inset 6px 6px 12px #a3b1c6, inset -6px -6px 12px #fff; border-radius:15px }
.neu-btn { background:#e0e5ec; box-shadow:4px 4px 8px #a3b1c6, -4px -4px 8px #fff; transition:all 0.2s ease; border-radius:10px }
.neu-btn:active { box-shadow:inset 3px 3px 6px #a3b1c6, inset -3px -3px 6px #fff; transform:scale(0.96) }
select { background:transparent; border:none; outline:none; font-weight:bold; cursor:pointer; color: #2563eb; appearance: none; text-align: center; width: 100% }
</style>
</head>

<body>
<div id="root"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, doc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDba3kZK5ibQEIRRjVIHL7JIOHixX_7rVs",
  authDomain: "ebada-656e1.firebaseapp.com",
  projectId: "ebada-656e1",
  storageBucket: "ebada-656e1.firebasestorage.app",
  messagingSenderId: "705608653939",
  appId: "1:705608653939:web:5ab3609a6f7ccc8675de06"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
window.docRef = doc(db, "worship", "family");
window.setDoc = setDoc;
window.onSnapshot = onSnapshot;
</script>

<script type="text/babel">
const { useState, useEffect, useRef } = React;

const hadiths = [
  "Â«Ø®ÙŠØ§Ø±ÙƒÙ… Ø®ÙŠØ§Ø±ÙƒÙ… Ù„Ø£Ù‡Ù„Ù‡Ù…Â»",
  "Â«Ø£Ø­Ø¨ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ù‡ Ø£Ø¯ÙˆÙ…Ù‡Ø§ ÙˆØ¥Ù† Ù‚Ù„Â»",
  "Â«Ù…Ù† Ø³Ù„Ùƒ Ø·Ø±ÙŠÙ‚Ø§Ù‹ ÙŠÙ„ØªÙ…Ø³ ÙÙŠÙ‡ Ø¹Ù„Ù…Ø§Ù‹ Ø³Ù‡Ù„ Ø§Ù„Ù„Ù‡ Ù„Ù‡ Ø·Ø±ÙŠÙ‚Ø§Ù‹ Ø¥Ù„Ù‰ Ø§Ù„Ø¬Ù†Ø©Â»",
  "Â«ÙƒÙ„Ù…ØªØ§Ù† Ø®ÙÙŠÙØªØ§Ù† Ø¹Ù„Ù‰ Ø§Ù„Ù„Ø³Ø§Ù†ØŒ Ø«Ù‚ÙŠÙ„ØªØ§Ù† ÙÙŠ Ø§Ù„Ù…ÙŠØ²Ø§Ù†: Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡ ÙˆØ¨Ø­Ù…Ø¯Ù‡Â»",
  "Â«Ø®ÙŠØ±ÙƒÙ… Ù…Ù† ØªØ¹Ù„Ù… Ø§Ù„Ù‚Ø±Ø¢Ù† ÙˆØ¹Ù„Ù…Ù‡Â»",
  "Â«Ø§ØªÙ‚ Ø§Ù„Ù„Ù‡ Ø­ÙŠØ«Ù…Ø§ ÙƒÙ†ØªØŒ ÙˆØ£ØªØ¨Ø¹ Ø§Ù„Ø³ÙŠØ¦Ø© Ø§Ù„Ø­Ø³Ù†Ø© ØªÙ…Ø­Ù‡Ø§Â»"
];

function App(){
  const users = ['Ù…Ø­Ù…Ø¯','Ø´ÙŠÙ…Ø§Ø¡','Ø£Ø­Ù…Ø¯','ÙŠØ§Ø³ÙŠÙ†'];
  const men = ['Ù…Ø­Ù…Ø¯','Ø£Ø­Ù…Ø¯','ÙŠØ§Ø³ÙŠÙ†'];
  const [date, setDate] = useState(new Date().toISOString().split('T')[0]);
  const [data, setData] = useState({});
  const [hadith, setHadith] = useState("");
  const latestData = useRef({});

  useEffect(() => {
    setHadith(hadiths[Math.floor(Math.random() * hadiths.length)]);
    const unsubscribe = window.onSnapshot(window.docRef, (snap) => {
      if (snap.exists()) {
        const cloudData = snap.data();
        latestData.current = cloudData;
        setData(cloudData);
      }
    });
    return () => unsubscribe();
  }, []);

  const update = async (user, task, val) => {
    const newData = {
      ...latestData.current,
      [date]: { ...latestData.current[date], [user]: { ...latestData.current[date]?.[user], [task]: val } }
    };
    try { await window.setDoc(window.docRef, newData); } 
    catch (e) { console.error(e); }
  };

  const isFriday = new Date(date).getDay() === 5;
  
  // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØµÙ„ÙˆØ§Øª Ø§Ù„Ù…ÙØ±ÙˆØ¶Ø©
  const prayers = ["ØµÙ„Ø§Ø© Ø§Ù„ÙØ¬Ø±", isFriday ? "ØµÙ„Ø§Ø© Ø§Ù„Ø¬Ù…Ø¹Ø©" : "ØµÙ„Ø§Ø© Ø§Ù„Ø¸Ù‡Ø±", "ØµÙ„Ø§Ø© Ø§Ù„Ø¹ØµØ±", "ØµÙ„Ø§Ø© Ø§Ù„Ù…ØºØ±Ø¨", "ØµÙ„Ø§Ø© Ø§Ù„Ø¹Ø´Ø§Ø¡"];
  
  // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³Ù†Ù† ÙˆØ§Ù„Ø±ÙˆØ§ØªØ¨ (ÙƒØ§Ù…Ù„Ø© ÙƒÙ…Ø§ ÙƒØ§Ù†Øª ÙÙŠ ÙƒÙˆØ¯Ùƒ Ø§Ù„Ø£ØµÙ„ÙŠ)
  const others = [
    "Ø³Ù†Ø© Ø§Ù„ÙØ¬Ø±", "Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­", "Ø§Ù„Ø¶Ø­Ù‰", "Ø³ÙˆØ±Ø© Ø§Ù„ÙƒÙ‡Ù", 
    "Ù¤ Ø±ÙƒØ¹Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø¸Ù‡Ø±", "Ø±ÙƒØ¹ØªØ§Ù† Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±", "Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡", 
    "Ø±ÙƒØ¹ØªØ§Ù† Ø¨Ø¹Ø¯ Ø§Ù„Ù…ØºØ±Ø¨", "Ø±ÙƒØ¹ØªØ§Ù† Ø¨Ø¹Ø¯ Ø§Ù„Ø¹Ø´Ø§Ø¡", "Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ù„Ùƒ", 
    "Ø§Ù„Ø´ÙØ¹ ÙˆØ§Ù„ÙˆØªØ±", "Ø§Ù„Ù‚ÙŠØ§Ù…", "Ø§Ù„ÙˆØ±Ø¯", "Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù†ÙˆÙ…"
  ].filter(i => isFriday || i !== "Ø³ÙˆØ±Ø© Ø§Ù„ÙƒÙ‡Ù");

  const getMotivation = (count) => {
    if (count === 0) return "Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ù‡Ù…ØªÙƒ.. ğŸš€";
    if (count < 6) return "Ø¨Ø¯Ø§ÙŠØ© Ø·ÙŠØ¨Ø©ØŒ Ø§Ø³ØªÙ…Ø±! ğŸŒ±";
    if (count < 12) return "Ø£Ø­Ø³Ù†ØªØŒ Ø£Ù†Øª ÙØ®Ø±Ù†Ø§! â­";
    return "Ù…Ø§ Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡ØŒ Ø¨Ø·Ù„ Ø§Ù„Ø·Ø§Ø¹Ø©! ğŸ†";
  };

  const scores = users.map(u => ({
    name: u,
    count: Object.values(data[date]?.[u] || {}).filter(v => v && v !== "Ù‚Ø¶Ø§Ø¡").length
  })).sort((a,b) => b.count - a.count);

  return (
    <div className="max-w-md mx-auto space-y-6 pb-12">
      <header className="neu-card p-6 text-center">
        <h1 className="text-2xl font-bold text-blue-700 mb-1">ğŸ  Ø¹Ø§Ø¦Ù„Ø© Ù…Ø­Ù…Ø¯ ÙŠØ§Ø³ÙŠÙ†</h1>
        <div className="neu-inset p-3 my-4 bg-white/30 italic text-sm text-blue-800">
           {hadith}
        </div>
        <div className="neu-inset p-1 text-blue-900">
          <input type="date" value={date} onChange={e => setDate(e.target.value)} 
            className="w-full text-center font-bold bg-transparent outline-none p-2 cursor-pointer"/>
        </div>
      </header>

      <div className="neu-card p-4 overflow-hidden">
        <h3 className="text-center font-bold mb-4 text-blue-600 border-b border-white/40 pb-2">Ø§Ù„ØµÙ„ÙˆØ§Øª Ø§Ù„Ù…ÙØ±ÙˆØ¶Ø©</h3>
        <div className="space-y-4">
          {prayers.map(p => (
            <div key={p} className="flex items-center justify-between text-sm">
              <span className="w-1/3 text-right font-bold text-slate-600">{p}</span>
              <div className="flex-1 flex justify-around">
                {users.map(u => (
                  <div key={u} className="w-10 text-center">
                    <select value={data[date]?.[u]?.[p] || ""} onChange={e => update(u, p, e.target.value)}>
                      <option value="">--</option>
                      {men.includes(u) ? <><option value="Ù…Ø³Ø¬Ø¯">ğŸ•Œ</option><option value="ÙØ±Ø¯">ğŸ </option></> : <option value="Ø­Ø§Ø¶Ø±">âœ…</option>}
                      <option value="Ù‚Ø¶Ø§Ø¡">â³</option>
                    </select>
                  </div>
                ))}
              </div>
            </div>
          ))}
        </div>

        <div className="h-px bg-white/50 my-6 shadow-inner"></div>

        <h3 className="text-center font-bold mb-4 text-blue-600 border-b border-white/40 pb-2">Ø§Ù„Ø³Ù†Ù† ÙˆØ§Ù„Ø£Ø°ÙƒØ§Ø±</h3>
        <div className="space-y-4">
          {others.map(t => (
            <div key={t} className="flex items-center justify-between text-[11px]">
              <span className="w-1/3 text-right text-slate-500 font-medium">{t}</span>
              <div className="flex-1 flex justify-around">
                {users.map(u => (
                  <button key={u} onClick={() => update(u, t, !data[date]?.[u]?.[t])}
                    className="w-8 h-8 neu-btn flex items-center justify-center transition-all">
                    {data[date]?.[u]?.[t] ? "âœ”ï¸" : ""}
                  </button>
                ))}
              </div>
            </div>
          ))}
        </div>
      </div>

      <div className="space-y-4">
        <h2 className="text-center font-bold text-slate-600 flex items-center justify-center gap-2">
          ğŸ† Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±Ù Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
        </h2>
        {scores.map((s, i) => (
          <div key={s.name} className="neu-card p-4 flex items-center justify-between">
            <div className="flex items-center gap-3">
              <span className={`w-8 h-8 flex items-center justify-center rounded-full font-bold shadow-sm ${i===0?'bg-yellow-400 text-white':'bg-blue-100 text-blue-600'}`}>{i+1}</span>
              <div>
                <p className="font-bold text-sm">{s.name}</p>
                <p className="text-[10px] text-blue-500 font-medium">{getMotivation(s.count)}</p>
              </div>
            </div>
            <div className="text-right">
              <span className="text-xl font-bold text-blue-700">{s.count}</span>
              <span className="text-[10px] block text-slate-400 uppercase tracking-tighter">Ù†Ù‚Ø·Ø© Ø·Ø§Ø¹Ø©</span>
            </div>
          </div>
        ))}
      </div>

      <footer className="text-center text-[10px] text-slate-400 pb-4">
        Ø­Ù‚ÙˆÙ‚ Ø§Ù„ØªØµÙ…ÙŠÙ… Ù…Ø­ÙÙˆØ¸Ø© Â©ï¸ Ø¹Ø§Ø¦Ù„Ø© ÙŠØ§Ø³ÙŠÙ† 2026
      </footer>
    </div>
  );
}

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<App />);
</script>
</body>
</html>
