<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ø­Ø±Ø§Ø¨ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</title>

<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Changa:wght@400;700;800&family=Amiri:wght@700&display=swap');

body { 
    font-family: 'Changa', sans-serif; 
    background: #f0f2f5; 
    color: #1a202c; 
    min-height: 100vh; 
}

/* Ø§Ù„Ø£ÙØ§ØªØ§Ø± Ø§Ù„Ù…Ù„ÙƒÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯ */
.royal-avatar {
    width: 60px; height: 60px;
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-weight: 800; font-size: 24px;
    color: white;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    box-shadow: 0 10px 20px rgba(0,0,0,0.1), inset 0 -4px 8px rgba(0,0,0,0.2);
    border: 2px solid rgba(255,255,255,0.8);
}

.avatar-m { background: linear-gradient(135deg, #b8860b 0%, #ffd700 50%, #b8860b 100%); } /* Ø°Ù‡Ø¨ÙŠ Ù„Ù…Ø­Ù…Ø¯ */
.avatar-s { background: linear-gradient(135deg, #ff69b4 0%, #ffb6c1 100%); } /* ÙˆØ±Ø¯ÙŠ Ù„Ø¤Ù„Ø¤ÙŠ Ù„Ø´ÙŠÙ…Ø§Ø¡ */
.avatar-a { background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); } /* Ø£Ø²Ø±Ù‚ Ù…Ù„ÙƒÙŠ Ù„Ø£Ø­Ù…Ø¯ */
.avatar-y { background: linear-gradient(135deg, #10b981 0%, #059669 100%); } /* Ø£Ø®Ø¶Ø± Ø²Ù…Ø±Ø¯ÙŠ Ù„ÙŠØ§Ø³ÙŠÙ† */

.neu-card { 
    background: #f0f2f5; 
    box-shadow: 20px 20px 60px #ccced0, -20px -20px 60px #ffffff;
    border-radius: 30px;
    padding: 20px;
    margin-bottom: 25px;
}

.hadith-banner {
    background: white;
    border-right: 6px solid #b8860b;
    border-radius: 15px;
    padding: 20px;
    text-align: center;
}
</style>
</head>

<body>
<div id="root"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, doc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDba3kZK5ibQEIRRjVIHL7JIOHixX_7rVs",
  authDomain: "ebada-656e1.firebaseapp.com",
  projectId: "ebada-656e1",
  storageBucket: "ebada-656e1.firebasestorage.app",
  messagingSenderId: "705608653939",
  appId: "1:705608653939:web:5ab3609a6f7ccc8675de06"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
window.docRef = doc(db, "worship", "family");
window.db = db;
window.setDoc = setDoc;
window.onSnapshot = onSnapshot;
</script>

<script type="text/babel">
const { useState, useEffect } = React;

const userStyles = {
  'Ù…Ø­Ù…Ø¯': 'avatar-m',
  'Ø´ÙŠÙ…Ø§Ø¡': 'avatar-s',
  'Ø£Ø­Ù…Ø¯': 'avatar-a',
  'ÙŠØ§Ø³ÙŠÙ†': 'avatar-y'
};

const userInitial = { 'Ù…Ø­Ù…Ø¯': 'Ù…', 'Ø´ÙŠÙ…Ø§Ø¡': 'Ø´', 'Ø£Ø­Ù…Ø¯': 'Ø£', 'ÙŠØ§Ø³ÙŠÙ†': 'ÙŠ' };

function App(){
  const users = ['Ù…Ø­Ù…Ø¯','Ø´ÙŠÙ…Ø§Ø¡','Ø£Ø­Ù…Ø¯','ÙŠØ§Ø³ÙŠÙ†'];
  const [date, setDate] = useState(new Date().toISOString().split('T')[0]);
  const [data, setData] = useState({});

  useEffect(() => {
    return window.onSnapshot(window.docRef, (snap) => {
      if (snap.exists()) setData(snap.data());
    });
  }, []);

  const update = async (user, task, val) => {
    const newData = { ...data, [date]: { ...data[date], [user]: { ...data[date]?.[user], [task]: val } } };
    await window.setDoc(window.docRef, newData);
  };

  const prayers = ["ØµÙ„Ø§Ø© Ø§Ù„ÙØ¬Ø±", "ØµÙ„Ø§Ø© Ø§Ù„Ø¸Ù‡Ø±", "ØµÙ„Ø§Ø© Ø§Ù„Ø¹ØµØ±", "ØµÙ„Ø§Ø© Ø§Ù„Ù…ØºØ±Ø¨", "ØµÙ„Ø§Ø© Ø§Ù„Ø¹Ø´Ø§Ø¡"];

  return (
    <div className="max-w-md mx-auto p-4">
      <header className="text-center py-6">
        <h1 className="text-3xl font-extrabold text-gray-800">Ø£Ø³Ø±ØªÙŠ ÙÙŠ Ø·Ø§Ø¹Ø© Ø§Ù„Ù„Ù‡</h1>
      </header>

      <div className="hadith-banner mb-8 shadow-sm">
        <p className="text-gray-500 text-xs mb-2">Ø­Ø¯ÙŠØ« Ø§Ù„ÙŠÙˆÙ…</p>
        <p className="text-xl font-bold text-gray-800 font-serif">Â«Ø£Ø­Ø¨ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ù‡ Ø£Ø¯ÙˆÙ…Ù‡Ø§ ÙˆØ¥Ù† Ù‚Ù„Â»</p>
      </div>

      <div className="neu-card">
        <h2 className="text-center font-bold mb-6">Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø·Ø§Ø¹Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠ</h2>
        <div className="overflow-x-auto">
          <table className="w-full">
            <thead>
              <tr>
                <th className="text-right p-2 text-sm text-gray-400">Ø§Ù„Ø¹Ø¨Ø§Ø¯Ø©</th>
                {users.map(u => (
                  <th key={u} className="p-2">
                    <div className={`royal-avatar mx-auto ${userStyles[u]}`}>
                      {userInitial[u]}
                    </div>
                    <span className="text-[10px] font-bold mt-1 block">{u}</span>
                  </th>
                ))}
              </tr>
            </thead>
            <tbody>
              {prayers.map(p => (
                <tr key={p} className="border-t border-gray-100">
                  <td className="py-4 text-xs font-bold text-gray-600">{p}</td>
                  {users.map(u => (
                    <td key={u} className="text-center">
                      <select 
                        value={data[date]?.[u]?.[p] || ""} 
                        onChange={e => update(u, p, e.target.value)}
                        className="bg-white border rounded-lg text-[10px] p-1 shadow-sm outline-none"
                      >
                        <option value="">--</option>
                        <option value="Ø­Ø§Ø¶Ø±">âœ…</option>
                        <option value="Ù…Ø³Ø¬Ø¯">ğŸ•Œ</option>
                        <option value="Ù‚Ø¶Ø§Ø¡">â³</option>
                      </select>
                    </td>
                  ))}
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  );
}

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<App />);
</script>
</body>
</html>
