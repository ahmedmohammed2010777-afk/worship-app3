<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø­Ø±Ø§Ø¨ Ø¹Ø§Ø¦Ù„Ø© Ù…Ø­Ù…Ø¯ 2026 - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Reem+Kufi:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #1a4d2e; --gold: #c5a059; --bg: #f9f6f0; }
        body {
            font-family: 'Amiri', serif; background-color: var(--bg);
            background-image: url('https://www.transparenttextures.com/patterns/islamic-art.png');
            margin: 0; padding: 10px; color: #2c3e50;
        }
        .main-container {
            max-width: 800px; margin: auto; background: rgba(255,255,255,0.98);
            border: 3px double var(--gold); border-radius: 20px; padding: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        h1, h2, h3 { font-family: 'Reem Kufi', sans-serif; color: var(--primary); text-align: center; }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ØªÙ‚ÙˆÙŠÙ… */
        .header-bar {
            background: var(--primary); color: white; padding: 15px;
            border-radius: 15px; border: 1px solid var(--gold); margin-bottom: 20px;
            text-align: center;
        }
        input[type="date"] {
            background: var(--gold); border: none; color: white; padding: 8px;
            border-radius: 8px; font-family: 'Amiri'; cursor: pointer; font-size: 1rem;
        }

        /* Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªÙ†Ø§ÙØ³ÙŠÙ† Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ© */
        .competitors-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 10px; margin-bottom: 20px; }
        .comp-card {
            background: white; border: 2px solid var(--gold); border-radius: 15px;
            padding: 10px; transition: 0.3s;
        }
        .comp-card.active { box-shadow: 0 0 15px var(--gold); transform: scale(1.02); border-width: 3px; }
        .comp-name { font-weight: bold; color: var(--primary); border-bottom: 1px solid #eee; margin-bottom: 5px; }
        .score { font-size: 1.2rem; color: var(--gold); font-weight: bold; }
        .remaining-list { font-size: 0.75rem; color: #a04040; text-align: right; min-height: 40px; }

        /* Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
        .section-card { background: white; border: 1px solid #ddd; border-radius: 12px; padding: 15px; margin-bottom: 15px; }
        .section-title { color: var(--primary); border-bottom: 2px solid var(--gold); padding-bottom: 5px; margin-bottom: 10px; font-weight: bold; display: flex; align-items: center; gap: 10px; }
        .habit-row { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px dashed #eee; }
        .habit-row a { text-decoration: none; color: var(--primary); font-weight: bold; }

        /* Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© */
        .chat-box { height: 120px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; background: #fff; margin-bottom: 10px; border-radius: 8px; }
    </style>
</head>
<body>

<div class="main-container">
    <h1>ğŸ•Œ Ù…Ø­Ø±Ø§Ø¨ Ø¹Ø§Ø¦Ù„Ø© Ù…Ø­Ù…Ø¯</h1>

    <div class="header-bar">
        <div>
            <span>Ø§Ø®ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ®: </span>
            <input type="date" id="date-picker" onchange="updateView()">
        </div>
        <div id="hijri-display" style="margin-top:10px; color: var(--gold); font-weight: bold;"></div>
    </div>

    <h3>ğŸ‘¤ Ø§Ø®ØªØ± Ø§Ù„Ù…ØªÙ†Ø§ÙØ³ Ù„ØªØ³Ø¬ÙŠÙ„ Ø·Ø§Ø¹Ø§ØªÙ‡</h3>
    <div class="competitors-grid">
        <div class="comp-card active" id="card-Ù…Ø­Ù…Ø¯" onclick="selectUser('Ù…Ø­Ù…Ø¯')">
            <div class="comp-name">Ø§Ù„Ø£Ø¨ Ù…Ø­Ù…Ø¯</div>
            <div class="score">Ù†Ù‚Ø§Ø·: <span id="score-Ù…Ø­Ù…Ø¯">0</span></div>
            <div class="remaining-list" id="rem-Ù…Ø­Ù…Ø¯">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨...</div>
        </div>
        <div class="comp-card" id="card-Ø´ÙŠÙ…Ø§Ø¡" onclick="selectUser('Ø´ÙŠÙ…Ø§Ø¡')">
            <div class="comp-name">Ø§Ù„Ø£Ù… Ø´ÙŠÙ…Ø§Ø¡</div>
            <div class="score">Ù†Ù‚Ø§Ø·: <span id="score-Ø´ÙŠÙ…Ø§Ø¡">0</span></div>
            <div class="remaining-list" id="rem-Ø´ÙŠÙ…Ø§Ø¡">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨...</div>
        </div>
        <div class="comp-card" id="card-Ø£Ø­Ù…Ø¯" onclick="selectUser('Ø£Ø­Ù…Ø¯')">
            <div class="comp-name">Ø£Ø­Ù…Ø¯</div>
            <div class="score">Ù†Ù‚Ø§Ø·: <span id="score-Ø£Ø­Ù…Ø¯">0</span></div>
            <div class="remaining-list" id="rem-Ø£Ø­Ù…Ø¯">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨...</div>
        </div>
        <div class="comp-card" id="card-ÙŠØ§Ø³ÙŠÙ†" onclick="selectUser('ÙŠØ§Ø³ÙŠÙ†')">
            <div class="comp-name">ÙŠØ§Ø³ÙŠÙ†</div>
            <div class="score">Ù†Ù‚Ø§Ø·: <span id="score-ÙŠØ§Ø³ÙŠÙ†">0</span></div>
            <div class="remaining-list" id="rem-ÙŠØ§Ø³ÙŠÙ†">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨...</div>
        </div>
    </div>

    <div class="section-card">
        <div class="section-title">ğŸ•‹ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø·Ø§Ø¹Ø§Øª Ù„Ù„ÙŠÙˆÙ…</div>
        <div id="habits-list">
            </div>
    </div>

    <div class="section-card">
        <div class="section-title">ğŸ’¬ Ù…Ù„ØªÙ‚Ù‰ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠ</div>
        <div id="chat-msgs" class="chat-box"></div>
        <div style="display: flex; gap: 5px;">
            <input type="text" id="chat-input" style="flex:1; padding:8px; border-radius:5px; border:1px solid #ccc;">
            <button onclick="sendMsg()" style="background:var(--primary); color:white; border:none; padding:8px 15px; border-radius:8px; cursor:pointer;">Ø¥Ø±Ø³Ø§Ù„</button>
        </div>
    </div>
</div>

<script>
    let currentUser = 'Ù…Ø­Ù…Ø¯';
    const allHabits = [
        {id: 'fajr', name: 'ØµÙ„Ø§Ø© Ø§Ù„ÙØ¬Ø±', pts: 10, link: null},
        {id: 'dhuhr', name: 'ØµÙ„Ø§Ø© Ø§Ù„Ø¸Ù‡Ø±', pts: 10, link: null},
        {id: 'asr', name: 'ØµÙ„Ø§Ø© Ø§Ù„Ø¹ØµØ±', pts: 10, link: null},
        {id: 'maghrib', name: 'ØµÙ„Ø§Ø© Ø§Ù„Ù…ØºØ±Ø¨', pts: 10, link: null},
        {id: 'isha', name: 'ØµÙ„Ø§Ø© Ø§Ù„Ø¹Ø´Ø§Ø¡', pts: 10, link: null},
        {id: 'sunan', name: 'Ø§Ù„Ø³Ù†Ù† Ø§Ù„Ø±ÙˆØ§ØªØ¨', pts: 5, link: null},
        {id: 'duha', name: 'ØµÙ„Ø§Ø© Ø§Ù„Ø¶Ø­Ù‰', pts: 5, link: null},
        {id: 'witr', name: 'Ø§Ù„Ø´ÙØ¹ ÙˆØ§Ù„ÙˆØªØ±', pts: 5, link: null},
        {id: 'morning', name: 'Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­', pts: 5, link: 'https://alazkar.today/'},
        {id: 'evening', name: 'Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡', pts: 5, link: 'https://alazkar.today/'},
        {id: 'sleep', name: 'Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù†ÙˆÙ…', pts: 5, link: 'https://alazkar.today/'},
        {id: 'mulk', name: 'Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ù„Ùƒ', pts: 10, link: 'https://quran.com/67'}
    ];

    function updateView() {
        const date = document.getElementById('date-picker').value;
        const hijri = new Intl.DateTimeFormat('ar-SA-u-ca-islamic-uma', {day:'numeric', month:'long', year:'numeric'}).format(new Date(date));
        document.getElementById('hijri-display').innerText = "Ø§Ù„Ù…ÙˆØ§ÙÙ‚ Ù‡Ø¬Ø±ÙŠØ§Ù‹: " + hijri;
        refreshAll();
    }

    function selectUser(user) {
        document.querySelectorAll('.comp-card').forEach(c => c.classList.remove('active'));
        document.getElementById('card-' + user).classList.add('active');
        currentUser = user;
        refreshAll();
    }

    function toggleHabit(habitId) {
        const date = document.getElementById('date-picker').value;
        const key = `data_${currentUser}_${date}_${habitId}`;
        const currentStatus = localStorage.getItem(key) === 'true';
        localStorage.setItem(key, !currentStatus);
        refreshAll();
    }

    function refreshAll() {
        const date = document.getElementById('date-picker').value;
        const users = ['Ù…Ø­Ù…Ø¯', 'Ø´ÙŠÙ…Ø§Ø¡', 'Ø£Ø­Ù…Ø¯', 'ÙŠØ§Ø³ÙŠÙ†'];
        
        users.forEach(u => {
            let score = 0;
            let remaining = [];
            allHabits.forEach(h => {
                const done = localStorage.getItem(`data_${u}_${date}_${h.id}`) === 'true';
                if(done) score += h.pts; else remaining.push(h.name);
            });
            document.getElementById(`score-${u}`).innerText = score;
            document.getElementById(`rem-${u}`).innerText = "Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: " + (remaining.length > 0 ? remaining.slice(0,3).join('ØŒ ') + '..' : 'âœ… Ø§ÙƒØªÙ…Ù„');
            
            if(u === currentUser) renderHabitsList(date);
        });
    }

    function renderHabitsList(date) {
        const container = document.getElementById('habits-list');
        container.innerHTML = allHabits.map(h => {
            const done = localStorage.getItem(`data_${currentUser}_${date}_${h.id}`) === 'true';
            return `
                <div class="habit-row">
                    ${h.link ? `<a href="${h.link}" target="_blank">ğŸ”— ${h.name}</a>` : `<span>${h.name}</span>`}
                    <input type="checkbox" ${done ? 'checked' : ''} onchange="toggleHabit('${h.id}')">
                </div>
            `;
        }).join('');
    }

    // Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© (ØªØµÙÙŠØ± ÙŠÙˆÙ…ÙŠ)
    function manageChat() {
        const today = new Date().toDateString();
        if(localStorage.getItem('chat_date') !== today) {
            localStorage.setItem('chat_log', JSON.stringify([]));
            localStorage.setItem('chat_date', today);
        }
        displayChat();
    }

    function sendMsg() {
        const input = document.getElementById('chat-input');
        if(!input.value) return;
        let msgs = JSON.parse(localStorage.getItem('chat_log') || "[]");
        msgs.push({ u: currentUser, t: input.value, time: new Date().toLocaleTimeString('ar-EG') });
        localStorage.setItem('chat_log', JSON.stringify(msgs));
        input.value = ""; displayChat();
    }

    function displayChat() {
        const box = document.getElementById('chat-msgs');
        let msgs = JSON.parse(localStorage.getItem('chat_log') || "[]");
        box.innerHTML = msgs.map(m => `<div><strong>${m.u}:</strong> ${m.t}</div>`).join('');
        box.scrollTop = box.scrollHeight;
    }

    window.onload = () => {
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('date-picker').value = today;
        updateView();
        manageChat();
    };
</script>
</body>
</html>
