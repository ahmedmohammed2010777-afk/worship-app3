<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ø­Ø±Ø§Ø¨ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</title>

<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Changa:wght@400;700;800&family=Amiri:wght@400;700&display=swap');

body { font-family: 'Changa', sans-serif; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); padding: 10px; color: #2d3436; min-height: 100vh; }
.neu-card { background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(10px); box-shadow: 20px 20px 60px #bebebe, -20px -20px 60px #ffffff; border-radius: 30px; margin-bottom: 25px; padding: 20px; }
.neu-inset { background: #eef2f7; box-shadow: inset 6px 6px 12px #d1d9e6, inset -6px -6px 12px #ffffff; border-radius: 20px; }
.royal-avatar { width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 20px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.3); box-shadow: 0 8px 15px rgba(0,0,0,0.1); border: 2px solid #fff; }
.av-m { background: linear-gradient(135deg, #b8860b 0%, #ffd700 50%, #b8860b 100%); }
.av-s { background: linear-gradient(135deg, #db2777 0%, #fbcfe8 100%); }
.av-a { background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); }
.av-y { background: linear-gradient(135deg, #059669 0%, #34d399 100%); }

/* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø£Ø°ÙƒØ§Ø± */
.modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); backdrop-filter: blur(8px); z-index: 100; display: flex; align-items: center; justify-content: center; padding: 20px; }
.modal-content { background: white; width: 100%; max-width: 400px; max-height: 80vh; overflow-y: auto; border-radius: 30px; padding: 25px; position: relative; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); }
.zekr-text { font-family: 'Amiri', serif; font-size: 1.3rem; line-height: 2.2; text-align: center; color: #2d3436; }
</style>
</head>

<body>
<div id="root"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, doc, setDoc, onSnapshot, arrayUnion } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDba3kZK5ibQEIRRjVIHL7JIOHixX_7rVs",
  authDomain: "ebada-656e1.firebaseapp.com",
  projectId: "ebada-656e1",
  storageBucket: "ebada-656e1.firebasestorage.app",
  messagingSenderId: "705608653939",
  appId: "1:705608653939:web:5ab3609a6f7ccc8675de06"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
window.docRef = doc(db, "worship", "family");
window.db = db;
window.setDoc = setDoc;
window.onSnapshot = onSnapshot;
window.arrayUnion = arrayUnion;
window.docFunc = doc;
</script>

<script type="text/babel">
const { useState, useEffect, useRef } = React;

const azkarData = {
  "Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­": "Ø¢ÙŠØ© Ø§Ù„ÙƒØ±Ø³ÙŠ.. Ø³ÙˆØ±Ø© Ø§Ù„Ø¥Ø®Ù„Ø§Øµ ÙˆØ§Ù„Ù…Ø¹ÙˆØ°ØªÙŠÙ† (3 Ù…Ø±Ø§Øª).. Ø£ØµØ¨Ø­Ù†Ø§ ÙˆØ£ØµØ¨Ø­ Ø§Ù„Ù…Ù„Ùƒ Ù„Ù„Ù‡.. Ø¨Ø³Ù… Ø§Ù„Ù„Ù‡ Ø§Ù„Ø°ÙŠ Ù„Ø§ ÙŠØ¶Ø± Ù…Ø¹ Ø§Ø³Ù…Ù‡ Ø´ÙŠØ¡.. Ø±ØµÙŠØ¯ Ù„Ø§ ÙŠÙ†ØªÙ‡ÙŠ Ù…Ù† Ø§Ù„Ø£Ø¬Ø±.",
  "Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡": "Ø¢ÙŠØ© Ø§Ù„ÙƒØ±Ø³ÙŠ.. Ø³ÙˆØ±Ø© Ø§Ù„Ø¥Ø®Ù„Ø§Øµ ÙˆØ§Ù„Ù…Ø¹ÙˆØ°ØªÙŠÙ† (3 Ù…Ø±Ø§Øª).. Ø£Ù…Ø³ÙŠÙ†Ø§ ÙˆØ£Ù…Ø³Ù‰ Ø§Ù„Ù…Ù„Ùƒ Ù„Ù„Ù‡.. Ø£Ø¹ÙˆØ° Ø¨ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù„Ù‡ Ø§Ù„ØªØ§Ù…Ø§Øª Ù…Ù† Ø´Ø± Ù…Ø§ Ø®Ù„Ù‚..",
  "Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ù„Ùƒ": "ØªÙØ¨ÙØ§Ø±ÙÙƒÙ Ø§Ù„Ù‘ÙØ°ÙÙŠ Ø¨ÙÙŠÙØ¯ÙÙ‡Ù Ø§Ù„Ù’Ù…ÙÙ„Ù’ÙƒÙ ÙˆÙÙ‡ÙÙˆÙ Ø¹ÙÙ„ÙÙ‰Ù° ÙƒÙÙ„Ù‘Ù Ø´ÙÙŠÙ’Ø¡Ù Ù‚ÙØ¯ÙÙŠØ±ÙŒ... (Ø§Ù„Ù…Ø§Ù†Ø¹Ø© Ù…Ù† Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø±)",
  "Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù†ÙˆÙ…": "Ø¨Ø§Ø³Ù…Ùƒ Ø±Ø¨ÙŠ ÙˆØ¶Ø¹Øª Ø¬Ù†Ø¨ÙŠ.. Ø¢ÙŠØ© Ø§Ù„ÙƒØ±Ø³ÙŠ.. Ø³ÙˆØ±Ø© Ø§Ù„Ø¥Ø®Ù„Ø§Øµ ÙˆØ§Ù„Ù…Ø¹ÙˆØ°ØªÙŠÙ†.. Ø³ÙØ¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡ (33) Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ (33) Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø± (34)",
  "Ø³ÙˆØ±Ø© Ø§Ù„ÙƒÙ‡Ù": "Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„Ù‘ÙÙ‡Ù Ø§Ù„Ù‘ÙØ°ÙÙŠ Ø£ÙÙ†Ø²ÙÙ„Ù Ø¹ÙÙ„ÙÙ‰Ù° Ø¹ÙØ¨Ù’Ø¯ÙÙ‡Ù Ø§Ù„Ù’ÙƒÙØªÙØ§Ø¨Ù ÙˆÙÙ„ÙÙ…Ù’ ÙŠÙØ¬Ù’Ø¹ÙÙ„ Ù„Ù‘ÙÙ‡Ù Ø¹ÙÙˆÙØ¬ÙØ§... (Ù†ÙˆØ± Ù…Ø§Ø¨ÙŠÙ† Ø§Ù„Ø¬Ù…Ø¹ØªÙŠÙ†)",
  "Ø§Ù„ÙˆØ±Ø¯ Ø§Ù„Ù‚Ø±Ø¢Ù†ÙŠ": "Ù‚Ø§Ù„ Ø±Ø³ÙˆÙ„ Ø§Ù„Ù„Ù‡ ï·º: Ø§Ù‚Ø±Ø¤ÙˆØ§ Ø§Ù„Ù‚Ø±Ø¢Ù† ÙØ¥Ù†Ù‡ ÙŠØ£ØªÙŠ ÙŠÙˆÙ… Ø§Ù„Ù‚ÙŠØ§Ù…Ø© Ø´ÙÙŠØ¹Ø§Ù‹ Ù„Ø£ØµØ­Ø§Ø¨Ù‡. (Ø­Ø¯Ø¯ Ø­Ø²Ø¨Ùƒ Ø§Ù„ÙŠÙˆÙ…ÙŠ ÙˆØ§Ø³ØªØ¹Ù† Ø¨Ø§Ù„Ù„Ù‡)"
};

const hadiths = ["Â«Ø®ÙŠØ§Ø±ÙƒÙ… Ø®ÙŠØ§Ø±ÙƒÙ… Ù„Ø£Ù‡Ù„Ù‡Ù…Â»", "Â«Ø£Ø­Ø¨ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ù‡ Ø£Ø¯ÙˆÙ…Ù‡Ø§ ÙˆØ¥Ù† Ù‚Ù„Â»", "Â«Ù…Ù† Ù‚Ø±Ø£ Ø³ÙˆØ±Ø© Ø§Ù„ÙƒÙ‡Ù ÙÙŠ ÙŠÙˆÙ… Ø§Ù„Ø¬Ù…Ø¹Ø© Ø£Ø¶Ø§Ø¡ Ù„Ù‡ Ù…Ù† Ø§Ù„Ù†ÙˆØ± Ù…Ø§ Ø¨ÙŠÙ† Ø§Ù„Ø¬Ù…Ø¹ØªÙŠÙ†Â»"];

function App(){
  const users = ['Ù…Ø­Ù…Ø¯','Ø´ÙŠÙ…Ø§Ø¡','Ø£Ø­Ù…Ø¯','ÙŠØ§Ø³ÙŠÙ†'];
  const [date, setDate] = useState(new Date().toISOString().split('T')[0]);
  const [data, setData] = useState({});
  const [activeZekr, setActiveZekr] = useState(null);
  const isFriday = new Date(date).getDay() === 5;

  useEffect(() => {
    return window.onSnapshot(window.docRef, (snap) => { if (snap.exists()) setData(snap.data()); });
  }, []);

  const update = async (user, task, val) => {
    const newData = { ...data, [date]: { ...data[date], [user]: { ...data[date]?.[user], [task]: val } } };
    await window.setDoc(window.docRef, newData);
  };

  const prayers = ["ØµÙ„Ø§Ø© Ø§Ù„ÙØ¬Ø±", isFriday ? "ØµÙ„Ø§Ø© Ø§Ù„Ø¬Ù…Ø¹Ø©" : "ØµÙ„Ø§Ø© Ø§Ù„Ø¸Ù‡Ø±", "ØµÙ„Ø§Ø© Ø§Ù„Ø¹ØµØ±", "ØµÙ„Ø§Ø© Ø§Ù„Ù…ØºØ±Ø¨", "ØµÙ„Ø§Ø© Ø§Ù„Ø¹Ø´Ø§Ø¡"];
  const sunan = ["Ø³Ù†Ø© Ø§Ù„ÙØ¬Ø± (Ù¢ Ø±ÙƒØ¹Ø©)", "Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­", "ØµÙ„Ø§Ø© Ø§Ù„Ø¶Ø­Ù‰", "Ø³Ù†Ø© Ø§Ù„Ø¸Ù‡Ø± (Ù¤ Ù‚Ø¨Ù„)", "Ø³Ù†Ø© Ø§Ù„Ø¸Ù‡Ø± (Ù¢ Ø¨Ø¹Ø¯)", "Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡", "Ø³Ù†Ø© Ø§Ù„Ù…ØºØ±Ø¨ (Ù¢ Ø¨Ø¹Ø¯)", "Ø³Ù†Ø© Ø§Ù„Ø¹Ø´Ø§Ø¡ (Ù¢ Ø¨Ø¹Ø¯)", "Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ù„Ùƒ", "Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù†ÙˆÙ…", "Ù‚ÙŠØ§Ù… Ø§Ù„Ù„ÙŠÙ„", "Ø§Ù„Ø´ÙØ¹ ÙˆØ§Ù„ÙˆØªØ±", "Ø§Ù„ÙˆØ±Ø¯ Ø§Ù„Ù‚Ø±Ø¢Ù†ÙŠ"];
  if (isFriday) sunan.splice(2, 0, "Ø³ÙˆØ±Ø© Ø§Ù„ÙƒÙ‡Ù");

  return (
    <div className="max-w-md mx-auto pb-10">
      <header className="text-center py-6">
        <h1 className="text-3xl font-black text-indigo-900">Ù…Ø­Ø±Ø§Ø¨ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© ğŸ </h1>
        {isFriday && <span className="bg-yellow-400 text-indigo-900 px-3 py-1 rounded-full text-[10px] font-bold">Ø¬Ù…Ø¹Ø© Ø·ÙŠØ¨Ø© âœ¨</span>}
      </header>

      {/* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */}
      {activeZekr && (
        <div className="modal-overlay" onClick={() => setActiveZekr(null)}>
          <div className="modal-content" onClick={e => e.stopPropagation()}>
            <button className="absolute top-4 left-4 text-gray-400 text-xl" onClick={() => setActiveZekr(null)}>âœ•</button>
            <h2 className="text-xl font-black text-indigo-600 mb-6 text-center">{activeZekr}</h2>
            <div className="zekr-text border-t pt-4 border-indigo-50">
              {azkarData[activeZekr] || "Ø§Ù„Ù†Øµ Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡ ÙƒØ§Ù…Ù„Ø§Ù‹ ÙÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¯Ù…..."}
            </div>
            <button className="w-full mt-8 py-3 bg-indigo-600 text-white rounded-2xl font-bold" onClick={() => setActiveZekr(null)}>ØµØ¯Ù‚ Ø§Ù„Ù„Ù‡ Ø§Ù„Ø¹Ø¸ÙŠÙ…</button>
          </div>
        </div>
      )}

      <div className="neu-card overflow-x-auto">
        <table className="w-full">
          <thead>
            <tr>
              <th className="py-2 pr-2 text-right text-xs text-gray-400">Ø§Ù„Ø¹Ø¨Ø§Ø¯Ø©</th>
              {users.map(u => (
                <th key={u} className="p-2">
                   <div className={`royal-avatar mx-auto ${u==='Ù…Ø­Ù…Ø¯'?'av-m':u==='Ø´ÙŠÙ…Ø§Ø¡'?'av-s':u==='Ø£Ø­Ù…Ø¯'?'av-a':'av-y'}`}>
                    {u==='Ù…Ø­Ù…Ø¯'?'Ù…':u==='Ø´ÙŠÙ…Ø§Ø¡'?'Ø´':u==='Ø£Ø­Ù…Ø¯'?'Ø£':'ÙŠ'}
                   </div>
                </th>
              ))}
            </tr>
          </thead>
          <tbody className="divide-y divide-gray-50">
            {prayers.map(p => (
              <tr key={p}>
                <td className="py-4 pr-2 text-right text-[10px] font-black text-gray-700">{p}</td>
                {users.map(u => (
                  <td key={u} className="text-center">
                    <select value={data[date]?.[u]?.[p] || ""} onChange={e => update(u, p, e.target.value)} className="neu-inset text-[9px] font-bold p-1 outline-none">
                      <option value="">-</option>
                      {['Ù…Ø­Ù…Ø¯','Ø£Ø­Ù…Ø¯','ÙŠØ§Ø³ÙŠÙ†'].includes(u) ? <><option value="Ù…Ø³Ø¬Ø¯">ğŸ•Œ</option><option value="ÙØ±Ø¯">ğŸ </option></> : <option value="Ø­Ø§Ø¶Ø±">âœ…</option>}
                    </select>
                  </td>
                ))}
              </tr>
            ))}
            <tr><td colSpan="5" className="py-2 bg-indigo-50 text-center text-[10px] font-black text-indigo-800">Ø§Ù„Ø³Ù†Ù† ÙˆØ§Ù„Ø£ÙˆØ±Ø§Ø¯ (Ø§Ø¶ØºØ· Ù„Ù„Ø§Ø·Ù„Ø§Ø¹)</td></tr>
            {sunan.map(s => (
                <tr key={s}>
                    <td className="py-3 pr-2 text-right text-[10px] text-indigo-500 font-bold cursor-help" onClick={() => azkarData[s] && setActiveZekr(s)}>
                      {s} {azkarData[s] && "ğŸ“–"}
                    </td>
                    {users.map(u => (
                        <td key={u} className="text-center">
                            <button onClick={() => update(u, s, !data[date]?.[u]?.[s])} className={`w-8 h-8 rounded-xl flex items-center justify-center border shadow-sm ${data[date]?.[u]?.[s] ? 'bg-indigo-600 text-white' : 'bg-white text-gray-200'}`}>
                                {data[date]?.[u]?.[s] ? "ğŸ’" : "â—‹"}
                            </button>
                        </td>
                    ))}
                </tr>
            ))}
          </tbody>
        </table>
      </div>
    </div>
  );
}

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<App />);
</script>
</body>
</html>
