<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ø­Ø±Ø§Ø¨ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø®ØªØ§Ù…ÙŠØ© Ø§Ù„Ø´Ø§Ù…Ù„Ø©</title>

<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Changa:wght@400;700;800&family=Amiri:wght@400;700&display=swap');

body { font-family: 'Changa', sans-serif; background: linear-gradient(135deg, #f0f4f8 0%, #d9e2ec 100%); padding: 10px; color: #102a43; min-height: 100vh; }
.neu-card { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); box-shadow: 15px 15px 40px #bcccdc, -15px -15px 40px #ffffff; border-radius: 35px; margin-bottom: 25px; padding: 25px; border: 1px solid rgba(255,255,255,0.6); }
.neu-inset { background: #f0f4f8; box-shadow: inset 4px 4px 8px #d1d9e6, inset -4px -4px 8px #ffffff; border-radius: 20px; }
.royal-avatar { width: 55px; height: 55px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 22px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.3); border: 2px solid #fff; box-shadow: 0 8px 16px rgba(0,0,0,0.1); }
.av-m { background: linear-gradient(135deg, #b8860b 0%, #ffd700 50%, #b8860b 100%); }
.av-s { background: linear-gradient(135deg, #db2777 0%, #fbcfe8 100%); }
.av-a { background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); }
.av-y { background: linear-gradient(135deg, #059669 0%, #34d399 100%); }

.modal-overlay { position: fixed; inset: 0; background: rgba(16, 42, 67, 0.85); backdrop-filter: blur(12px); z-index: 2000; display: flex; align-items: center; justify-content: center; padding: 15px; }
.modal-content { background: #fff; width: 100%; max-width: 550px; max-height: 90vh; overflow-y: auto; border-radius: 40px; padding: 30px; position: relative; border: 8px solid #f0f4f8; }
.quran-text { font-family: 'Amiri', serif; font-size: 1.5rem; line-height: 2.5; text-align: center; color: #102a43; word-spacing: 4px; }
.zekr-item { background: #f8fafc; border-radius: 20px; padding: 20px; margin-bottom: 15px; border-right: 6px solid #627d98; box-shadow: 0 4px 6px rgba(0,0,0,0.02); }
.counter-badge { background: #627d98; color: white; padding: 2px 10px; border-radius: 10px; font-size: 0.8rem; margin-right: 8px; }
</style>
</head>

<body>
<div id="root"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, doc, setDoc, onSnapshot, arrayUnion } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDba3kZK5ibQEIRRjVIHL7JIOHixX_7rVs",
  authDomain: "ebada-656e1.firebaseapp.com",
  projectId: "ebada-656e1",
  storageBucket: "ebada-656e1.firebasestorage.app",
  messagingSenderId: "705608653939",
  appId: "1:705608653939:web:5ab3609a6f7ccc8675de06"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
window.docRef = doc(db, "worship", "family");
window.db = db;
window.setDoc = setDoc;
window.onSnapshot = onSnapshot;
window.arrayUnion = arrayUnion;
window.docFunc = doc;
</script>

<script type="text/babel">
const { useState, useEffect, useRef } = React;

const contentLibrary = {
  "Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­": [
    { m: "Ø¢ÙŠØ© Ø§Ù„ÙƒØ±Ø³ÙŠ", t: "Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ù„ÙØ§ Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„Ù‘ÙØ§ Ù‡ÙÙˆÙ Ø§Ù„Ù’Ø­ÙÙŠÙ‘Ù Ø§Ù„Ù’Ù‚ÙÙŠÙ‘ÙÙˆÙ…Ù Ù„ÙØ§ ØªÙØ£Ù’Ø®ÙØ°ÙÙ‡Ù Ø³ÙÙ†ÙØ©ÙŒ ÙˆÙÙ„ÙØ§ Ù†ÙÙˆÙ’Ù…ÙŒ Ù„ÙÙ‡Ù Ù…ÙØ§ ÙÙÙŠ Ø§Ù„Ø³Ù‘ÙÙ…ÙØ§ÙˆÙØ§ØªÙ ÙˆÙÙ…ÙØ§ ÙÙÙŠ Ø§Ù„Ù’Ø£ÙØ±Ù’Ø¶Ù Ù…ÙÙ†Ù’ Ø°ÙØ§ Ø§Ù„Ù‘ÙØ°ÙÙŠ ÙŠÙØ´Ù’ÙÙØ¹Ù Ø¹ÙÙ†Ù’Ø¯ÙÙ‡Ù Ø¥ÙÙ„Ù‘ÙØ§ Ø¨ÙØ¥ÙØ°Ù’Ù†ÙÙ‡Ù ÙŠÙØ¹Ù’Ù„ÙÙ…Ù Ù…ÙØ§ Ø¨ÙÙŠÙ’Ù†Ù Ø£ÙÙŠÙ’Ø¯ÙÙŠÙ‡ÙÙ…Ù’ ÙˆÙÙ…ÙØ§ Ø®ÙÙ„Ù’ÙÙÙ‡ÙÙ…Ù’ ÙˆÙÙ„ÙØ§ ÙŠÙØ­ÙÙŠØ·ÙÙˆÙ†Ù Ø¨ÙØ´ÙÙŠÙ’Ø¡Ù Ù…ÙÙ†Ù’ Ø¹ÙÙ„Ù’Ù…ÙÙ‡Ù Ø¥ÙÙ„Ù‘ÙØ§ Ø¨ÙÙ…ÙØ§ Ø´ÙØ§Ø¡Ù ÙˆÙØ³ÙØ¹Ù ÙƒÙØ±Ù’Ø³ÙÙŠÙ‘ÙÙ‡Ù Ø§Ù„Ø³Ù‘ÙÙ…ÙØ§ÙˆÙØ§ØªÙ ÙˆÙØ§Ù„Ù’Ø£ÙØ±Ù’Ø¶Ù ÙˆÙÙ„ÙØ§ ÙŠÙØ¦ÙÙˆØ¯ÙÙ‡Ù Ø­ÙÙÙ’Ø¸ÙÙ‡ÙÙ…ÙØ§ ÙˆÙÙ‡ÙÙˆÙ Ø§Ù„Ù’Ø¹ÙÙ„ÙÙŠÙ‘Ù Ø§Ù„Ù’Ø¹ÙØ¸ÙÙŠÙ…Ù", c: "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©" },
    { m: "Ø³ÙŠØ¯ Ø§Ù„Ø§Ø³ØªØºÙØ§Ø±", t: "Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø£ÙÙ†Ù’ØªÙ Ø±ÙØ¨Ù‘ÙÙŠ Ù„ÙØ§ Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„Ù‘ÙØ§ Ø£ÙÙ†Ù’ØªÙØŒ Ø®ÙÙ„ÙÙ‚Ù’ØªÙÙ†ÙÙŠ ÙˆÙØ£ÙÙ†ÙØ§ Ø¹ÙØ¨Ù’Ø¯ÙÙƒÙØŒ ÙˆÙØ£ÙÙ†ÙØ§ Ø¹ÙÙ„ÙÙ‰ Ø¹ÙÙ‡Ù’Ø¯ÙÙƒÙ ÙˆÙÙˆÙØ¹Ù’Ø¯ÙÙƒÙ Ù…ÙØ§ Ø§Ø³Ù’ØªÙØ·ÙØ¹Ù’ØªÙØŒ Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙ Ù…ÙÙ†Ù’ Ø´ÙØ±Ù‘Ù Ù…ÙØ§ ØµÙÙ†ÙØ¹Ù’ØªÙØŒ Ø£ÙØ¨ÙÙˆØ¡Ù Ù„ÙÙƒÙ Ø¨ÙÙ†ÙØ¹Ù’Ù…ÙØªÙÙƒÙ Ø¹ÙÙ„ÙÙŠÙ‘ÙØŒ ÙˆÙØ£ÙØ¨ÙÙˆØ¡Ù Ù„ÙÙƒÙ Ø¨ÙØ°ÙÙ†Ù’Ø¨ÙÙŠ ÙÙØ§ØºÙ’ÙÙØ±Ù’ Ù„ÙÙŠ ÙÙØ¥ÙÙ†Ù‘ÙÙ‡Ù Ù„ÙØ§ ÙŠÙØºÙ’ÙÙØ±Ù Ø§Ù„Ø°Ù‘ÙÙ†ÙÙˆØ¨Ù Ø¥ÙÙ„Ù‘ÙØ§ Ø£ÙÙ†Ù’ØªÙ", c: "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©" },
    { m: "Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ø­Ù…Ø§ÙŠØ©", t: "Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø§Ù„Ù‘ÙØ°ÙÙŠ Ù„ÙØ§ ÙŠÙØ¶ÙØ±Ù‘Ù Ù…ÙØ¹Ù Ø§Ø³Ù’Ù…ÙÙ‡Ù Ø´ÙÙŠÙ’Ø¡ÙŒ ÙÙÙŠ Ø§Ù„Ù’Ø£ÙØ±Ù’Ø¶Ù ÙˆÙÙ„ÙØ§ ÙÙÙŠ Ø§Ù„Ø³Ù‘ÙÙ…ÙØ§Ø¡Ù ÙˆÙÙ‡ÙÙˆÙ Ø§Ù„Ø³Ù‘ÙÙ…ÙÙŠØ¹Ù Ø§Ù„Ù’Ø¹ÙÙ„ÙÙŠÙ…Ù", c: "3 Ù…Ø±Ø§Øª" }
  ],
  "Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ù„Ùƒ": [
    { m: "ÙƒØ§Ù…Ù„Ø©", t: "ØªÙØ¨ÙØ§Ø±ÙÙƒÙ Ø§Ù„Ù‘ÙØ°ÙÙŠ Ø¨ÙÙŠÙØ¯ÙÙ‡Ù Ø§Ù„Ù’Ù…ÙÙ„Ù’ÙƒÙ ÙˆÙÙ‡ÙÙˆÙ Ø¹ÙÙ„ÙÙ‰Ù° ÙƒÙÙ„Ù‘Ù Ø´ÙÙŠÙ’Ø¡Ù Ù‚ÙØ¯ÙÙŠØ±ÙŒ (1) Ø§Ù„Ù‘ÙØ°ÙÙŠ Ø®ÙÙ„ÙÙ‚Ù Ø§Ù„Ù’Ù…ÙÙˆÙ’ØªÙ ÙˆÙØ§Ù„Ù’Ø­ÙÙŠÙØ§Ø©Ù Ù„ÙÙŠÙØ¨Ù’Ù„ÙÙˆÙÙƒÙÙ…Ù’ Ø£ÙÙŠÙ‘ÙÙƒÙÙ…Ù’ Ø£ÙØ­Ù’Ø³ÙÙ†Ù Ø¹ÙÙ…ÙÙ„Ù‹Ø§ ÙˆÙÙ‡ÙÙˆÙ Ø§Ù„Ù’Ø¹ÙØ²ÙÙŠØ²Ù Ø§Ù„Ù’ØºÙÙÙÙˆØ±Ù (2) Ø§Ù„Ù‘ÙØ°ÙÙŠ Ø®ÙÙ„ÙÙ‚Ù Ø³ÙØ¨Ù’Ø¹Ù Ø³ÙÙ…ÙØ§ÙˆÙØ§ØªÙ Ø·ÙØ¨ÙØ§Ù‚Ù‹Ø§ Ù…Ù‘ÙØ§ ØªÙØ±ÙÙ‰Ù° ÙÙÙŠ Ø®ÙÙ„Ù’Ù‚Ù Ø§Ù„Ø±Ù‘ÙØ­Ù’Ù…ÙÙ°Ù†Ù Ù…ÙÙ† ØªÙÙÙØ§ÙˆÙØªÙ ÙÙØ§Ø±Ù’Ø¬ÙØ¹Ù Ø§Ù„Ù’Ø¨ÙØµÙØ±Ù Ù‡ÙÙ„Ù’ ØªÙØ±ÙÙ‰Ù° Ù…ÙÙ† ÙÙØ·ÙÙˆØ±Ù (3) Ø«ÙÙ…Ù‘Ù Ø§Ø±Ù’Ø¬ÙØ¹Ù Ø§Ù„Ù’Ø¨ÙØµÙØ±Ù ÙƒÙØ±Ù‘ÙØªÙÙŠÙ’Ù†Ù ÙŠÙÙ†Ù‚ÙÙ„ÙØ¨Ù’ Ø¥ÙÙ„ÙÙŠÙ’ÙƒÙ Ø§Ù„Ù’Ø¨ÙØµÙØ±Ù Ø®ÙØ§Ø³ÙØ¦Ù‹Ø§ ÙˆÙÙ‡ÙÙˆÙ Ø­ÙØ³ÙÙŠØ±ÙŒ (4)... [ÙŠÙØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø³ÙˆØ±Ø© Ù…Ù† Ø§Ù„Ù‚Ù„Ø¨ Ø£Ùˆ Ø§Ù„Ù…ØµØ­Ù ØªØ¹Ø¸ÙŠÙ…Ø§Ù‹ Ù„Ù„Ø£Ø¬Ø±]", c: "30 Ø¢ÙŠØ©" }
  ],
  "Ø³ÙˆØ±Ø© Ø§Ù„ÙƒÙ‡Ù": [
    { m: "Ù†ÙˆØ± Ø§Ù„Ø¬Ù…Ø¹Ø©", t: "Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„Ù‘ÙÙ‡Ù Ø§Ù„Ù‘ÙØ°ÙÙŠ Ø£ÙÙ†Ø²ÙÙ„Ù Ø¹ÙÙ„ÙÙ‰Ù° Ø¹ÙØ¨Ù’Ø¯ÙÙ‡Ù Ø§Ù„Ù’ÙƒÙØªÙØ§Ø¨Ù ÙˆÙÙ„ÙÙ…Ù’ ÙŠÙØ¬Ù’Ø¹ÙÙ„ Ù„Ù‘ÙÙ‡Ù Ø¹ÙÙˆÙØ¬ÙØ§ Ûœ (1) Ù‚ÙÙŠÙ‘ÙÙ…Ù‹Ø§ Ù„Ù‘ÙÙŠÙÙ†Ø°ÙØ±Ù Ø¨ÙØ£Ù’Ø³Ù‹Ø§ Ø´ÙØ¯ÙÙŠØ¯Ù‹Ø§ Ù…Ù‘ÙÙ† Ù„Ù‘ÙØ¯ÙÙ†Ù’Ù‡Ù ÙˆÙÙŠÙØ¨ÙØ´Ù‘ÙØ±Ù Ø§Ù„Ù’Ù…ÙØ¤Ù’Ù…ÙÙ†ÙÙŠÙ†Ù Ø§Ù„Ù‘ÙØ°ÙÙŠÙ†Ù ÙŠÙØ¹Ù’Ù…ÙÙ„ÙÙˆÙ†Ù Ø§Ù„ØµÙ‘ÙØ§Ù„ÙØ­ÙØ§ØªÙ Ø£ÙÙ†Ù‘Ù Ù„ÙÙ‡ÙÙ…Ù’ Ø£ÙØ¬Ù’Ø±Ù‹Ø§ Ø­ÙØ³ÙÙ†Ù‹Ø§ (2) Ù…Ù‘ÙØ§ÙƒÙØ«ÙÙŠÙ†Ù ÙÙÙŠÙ‡Ù Ø£ÙØ¨ÙØ¯Ù‹Ø§ (3) ÙˆÙÙŠÙÙ†Ø°ÙØ±Ù Ø§Ù„Ù‘ÙØ°ÙÙŠÙ†Ù Ù‚ÙØ§Ù„ÙÙˆØ§ Ø§ØªÙ‘ÙØ®ÙØ°Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù ÙˆÙÙ„ÙØ¯Ù‹Ø§ (4)... [ÙŠÙØ³ØªØ­Ø¨ Ù‚Ø±Ø§Ø¡ØªÙ‡Ø§ ÙƒØ§Ù…Ù„Ø© ÙŠÙˆÙ… Ø§Ù„Ø¬Ù…Ø¹Ø©]", c: "110 Ø¢ÙŠØ§Øª" }
  ],
  "Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù†ÙˆÙ…": [
    { m: "Ø§Ù„ØªØ³Ø¨ÙŠØ­", t: "Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡ (33)ØŒ Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ (33)ØŒ Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø± (34)", c: "100 Ù…Ø±Ø©" },
    { m: "Ø¨Ø§Ø³Ù…Ùƒ Ø±Ø¨ÙŠ", t: "Ø¨ÙØ§Ø³Ù’Ù…ÙÙƒÙ Ø±ÙØ¨Ù‘ÙÙŠ ÙˆÙØ¶ÙØ¹Ù’ØªÙ Ø¬ÙÙ†Ù’Ø¨ÙÙŠØŒ ÙˆÙØ¨ÙÙƒÙ Ø£ÙØ±Ù’ÙÙØ¹ÙÙ‡ÙØŒ ÙÙØ¥ÙÙ†Ù’ Ø£ÙÙ…Ù’Ø³ÙÙƒÙ’ØªÙ Ù†ÙÙÙ’Ø³ÙÙŠ ÙÙØ§Ø±Ù’Ø­ÙÙ…Ù’Ù‡ÙØ§ØŒ ÙˆÙØ¥ÙÙ†Ù’ Ø£ÙØ±Ù’Ø³ÙÙ„Ù’ØªÙÙ‡ÙØ§ ÙÙØ§Ø­Ù’ÙÙØ¸Ù’Ù‡ÙØ§ Ø¨ÙÙ…ÙØ§ ØªÙØ­Ù’ÙÙØ¸Ù Ø¨ÙÙ‡Ù Ø¹ÙØ¨ÙØ§Ø¯ÙÙƒÙ Ø§Ù„ØµÙ‘ÙØ§Ù„ÙØ­ÙÙŠÙ†Ù", c: "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©" }
  ]
};

const hadiths = [
  "Â«Ø®ÙŠØ§Ø±ÙƒÙ… Ø®ÙŠØ§Ø±ÙƒÙ… Ù„Ø£Ù‡Ù„Ù‡Ù…Â»",
  "Â«Ø£Ø­Ø¨ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ù‡ Ø£Ø¯ÙˆÙ…Ù‡Ø§ ÙˆØ¥Ù† Ù‚Ù„Â»",
  "Â«Ø®ÙŠØ±ÙƒÙ… Ù…Ù† ØªØ¹Ù„Ù… Ø§Ù„Ù‚Ø±Ø¢Ù† ÙˆØ¹Ù„Ù…Ù‡Â»",
  "Â«Ù…Ù† ØµÙ„Ù‰ Ø§Ù„Ø¨Ø±Ø¯ÙŠÙ† Ø¯Ø®Ù„ Ø§Ù„Ø¬Ù†Ø©Â»"
];

function App(){
  const users = ['Ù…Ø­Ù…Ø¯','Ø´ÙŠÙ…Ø§Ø¡','Ø£Ø­Ù…Ø¯','ÙŠØ§Ø³ÙŠÙ†'];
  const [date, setDate] = useState(new Date().toISOString().split('T')[0]);
  const [data, setData] = useState({});
  const [messages, setMessages] = useState([]);
  const [newMsg, setNewMsg] = useState("");
  const [currentUser, setCurrentUser] = useState("Ù…Ø­Ù…Ø¯");
  const [activeView, setActiveView] = useState(null);
  const latestData = useRef({});

  const isFriday = new Date(date).getDay() === 5;

  useEffect(() => {
    const unsubData = window.onSnapshot(window.docRef, (snap) => {
      if (snap.exists()) { latestData.current = snap.data(); setData(snap.data()); }
    });
    const dailyChatRef = window.docFunc(window.db, "chats", date);
    const unsubChat = window.onSnapshot(dailyChatRef, (snap) => {
      if (snap.exists()) setMessages(snap.data().messages || []);
      else setMessages([]);
    });
    return () => { unsubData(); unsubChat(); };
  }, [date]);

  const update = async (user, task, val) => {
    const newData = { ...latestData.current, [date]: { ...latestData.current[date], [user]: { ...latestData.current[date]?.[user], [task]: val } } };
    await window.setDoc(window.docRef, newData);
  };

  const sendChat = async () => {
    if (!newMsg.trim()) return;
    const dailyChatRef = window.docFunc(window.db, "chats", date);
    await window.setDoc(dailyChatRef, { 
      messages: window.arrayUnion({ user: currentUser, text: newMsg, time: new Date().toLocaleTimeString('ar-EG', {hour:'2-digit', minute:'2-digit'}) }) 
    }, { merge: true });
    setNewMsg("");
  };

  const prayers = ["ØµÙ„Ø§Ø© Ø§Ù„ÙØ¬Ø±", isFriday ? "ØµÙ„Ø§Ø© Ø§Ù„Ø¬Ù…Ø¹Ø©" : "ØµÙ„Ø§Ø© Ø§Ù„Ø¸Ù‡Ø±", "ØµÙ„Ø§Ø© Ø§Ù„Ø¹ØµØ±", "ØµÙ„Ø§Ø© Ø§Ù„Ù…ØºØ±Ø¨", "ØµÙ„Ø§Ø© Ø§Ù„Ø¹Ø´Ø§Ø¡"];
  const sunan = ["Ø³Ù†Ø© Ø§Ù„ÙØ¬Ø± (Ù¢ Ø±ÙƒØ¹Ø©)", "Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­", "ØµÙ„Ø§Ø© Ø§Ù„Ø¶Ø­Ù‰", "Ø³Ù†Ø© Ø§Ù„Ø¸Ù‡Ø± (Ù¤ Ù‚Ø¨Ù„)", "Ø³Ù†Ø© Ø§Ù„Ø¸Ù‡Ø± (Ù¢ Ø¨Ø¹Ø¯)", "Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡", "Ø³Ù†Ø© Ø§Ù„Ù…ØºØ±Ø¨ (Ù¢ Ø¨Ø¹Ø¯)", "Ø³Ù†Ø© Ø§Ù„Ø¹Ø´Ø§Ø¡ (Ù¢ Ø¨Ø¹Ø¯)", "Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ù„Ùƒ", "Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù†ÙˆÙ…", "Ù‚ÙŠØ§Ù… Ø§Ù„Ù„ÙŠÙ„", "Ø§Ù„Ø´ÙØ¹ ÙˆØ§Ù„ÙˆØªØ±", "Ø§Ù„ÙˆØ±Ø¯ Ø§Ù„Ù‚Ø±Ø¢Ù†ÙŠ"];
  if (isFriday) sunan.splice(2, 0, "Ø³ÙˆØ±Ø© Ø§Ù„ÙƒÙ‡Ù");

  const scores = users.map(u => {
    const d = data[date]?.[u] || {};
    let s = 0;
    Object.values(d).forEach(v => { if(v===true || v==="Ù…Ø³Ø¬Ø¯" || v==="Ø­Ø§Ø¶Ø±") s+=3; else if(v==="ÙØ±Ø¯") s+=2; else if(v==="Ù‚Ø¶Ø§Ø¡") s+=1; });
    return { name: u, score: s, pending: (prayers.length + sunan.length) - Object.values(d).filter(v=>v).length };
  }).sort((a,b) => b.score - a.score);

  return (
    <div className="max-w-md mx-auto pb-10">
      {/* Ù†Ø§ÙØ°Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰ */}
      {activeView && (
        <div className="modal-overlay" onClick={() => setActiveView(null)}>
          <div className="modal-content" onClick={e => e.stopPropagation()}>
            <h2 className="text-2xl font-black text-indigo-900 mb-6 text-center border-b-4 border-indigo-100 pb-3">{activeView}</h2>
            {contentLibrary[activeView]?.map((item, i) => (
              <div key={i} className="zekr-item">
                <div className="flex justify-between mb-2">
                  <span className="font-bold text-indigo-600">âœ¦ {item.m}</span>
                  <span className="counter-badge">{item.c}</span>
                </div>
                <p className="quran-text">{item.text}</p>
              </div>
            )) || <p className="text-center py-10">ØªÙ‚Ø¨Ù„ Ø§Ù„Ù„Ù‡ Ø·Ø§Ø¹ØªÙƒÙ…..</p>}
            <button className="w-full mt-6 py-4 bg-indigo-900 text-white rounded-2xl font-black text-lg" onClick={() => setActiveView(null)}>ØªÙ…Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© âœ…</button>
          </div>
        </div>
      )}

      <header className="text-center py-8">
        <h1 className="text-3xl font-black text-indigo-900 drop-shadow-md">Ù…ÙØ­Ù’Ø±Ø§Ø¨Ù Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© âœ¨</h1>
      </header>

      {/* Ø§Ù„Ø­Ø¯ÙŠØ« Ø§Ù„Ø´Ø±ÙŠÙ */}
      <div className="neu-card bg-indigo-900 text-white border-r-8 border-yellow-400">
        <h3 className="text-[10px] font-bold opacity-70 mb-2 underline">Ø²ÙØ§Ø¯Ù Ø§Ù„ÙŠÙÙˆÙ…Ù</h3>
        <p className="text-xl font-bold font-serif text-center">{hadiths[new Date(date).getDate() % hadiths.length]}</p>
      </div>

      {/* Ù…Ù†ØµØ© Ø§Ù„ØªØªÙˆÙŠØ¬ Ø§Ù„Ù…Ù„ÙƒÙŠØ© */}
      <div className="neu-card">
        <h2 className="text-center font-black mb-10 text-indigo-900">ğŸ† ÙÙØ±Ø³Ø§Ù† Ø§Ù„Ø·Ø§Ø¹Ø©</h2>
        <div className="flex justify-center items-end gap-3 h-48 border-b-2 border-indigo-50 pb-2 mb-4">
          <div className="flex flex-col items-center w-1/3">
             <div className={`royal-avatar mb-2 ${scores[1].name==='Ù…Ø­Ù…Ø¯'?'av-m':scores[1].name==='Ø´ÙŠÙ…Ø§Ø¡'?'av-s':scores[1].name==='Ø£Ø­Ù…Ø¯'?'av-a':'av-y'}`}>
              {scores[1].name[0]}
             </div>
             <div className="h-20 w-full bg-slate-200 rounded-t-2xl flex items-center justify-center font-black text-slate-500 text-2xl shadow-inner">2</div>
          </div>
          <div className="flex flex-col items-center w-1/3">
             <span className="text-3xl mb-1 animate-bounce">ğŸ‘‘</span>
             <div className={`royal-avatar mb-2 scale-125 ${scores[0].name==='Ù…Ø­Ù…Ø¯'?'av-m':scores[0].name==='Ø´ÙŠÙ…Ø§Ø¡'?'av-s':scores[0].name==='Ø£Ø­Ù…Ø¯'?'av-a':'av-y'}`}>
              {scores[0].name[0]}
             </div>
             <div className="h-32 w-full bg-yellow-400 rounded-t-2xl flex items-center justify-center font-black text-yellow-900 text-4xl shadow-lg border-x-4 border-yellow-500">1</div>
          </div>
          <div className="flex flex-col items-center w-1/3">
             <div className={`royal-avatar mb-2 ${scores[2].name==='Ù…Ø­Ù…Ø¯'?'av-m':scores[2].name==='Ø´ÙŠÙ…Ø§Ø¡'?'av-s':scores[2].name==='Ø£Ø­Ù…Ø¯'?'av-a':'av-y'}`}>
              {scores[2].name[0]}
             </div>
             <div className="h-12 w-full bg-orange-200 rounded-t-2xl flex items-center justify-center font-black text-orange-700 text-xl shadow-inner">3</div>
          </div>
        </div>
        {scores.map(s => s.pending > 0 && (
          <div key={s.name} className="text-[10px] text-gray-400 flex justify-between px-4">
            <span>Ø¨Ø§Ù‚ÙŠ Ù„Ù€ <b>{s.name}</b> {s.pending} Ø·Ø§Ø¹Ø§Øª</span>
            <span className="font-bold text-indigo-500 italic">Ù‡Ù…Ù‘Ø©!</span>
          </div>
        ))}
      </div>

      {/* ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ… */}
      <div className="neu-card p-4 text-center">
        <input type="date" value={date} onChange={e => setDate(e.target.value)} className="neu-inset px-6 py-2 font-bold text-indigo-900 outline-none"/>
      </div>

      {/* Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¹Ø¨Ø§Ø¯Ø§Øª */}
      <div className="neu-card overflow-x-auto">
        <table className="w-full">
          <thead>
            <tr className="border-b-2 border-indigo-50">
              <th className="py-2 pr-2 text-right text-xs text-indigo-400">Ø§Ù„Ø¹Ø¨Ø§Ø¯Ø©</th>
              {users.map(u => (
                <th key={u} className="p-2">
                   <div className={`royal-avatar w-10 h-10 text-sm mx-auto ${u==='Ù…Ø­Ù…Ø¯'?'av-m':u==='Ø´ÙŠÙ…Ø§Ø¡'?'av-s':u==='Ø£Ø­Ù…Ø¯'?'av-a':'av-y'}`}>{u[0]}</div>
                </th>
              ))}
            </tr>
          </thead>
          <tbody className="divide-y divide-slate-50">
            {prayers.map(p => (
              <tr key={p}>
                <td className="py-4 pr-2 text-[11px] font-black text-slate-700">{p}</td>
                {users.map(u => (
                  <td key={u} className="text-center">
                    <select value={data[date]?.[u]?.[p] || ""} onChange={e => update(u, p, e.target.value)} className="neu-inset text-[10px] font-bold p-1 outline-none text-indigo-700">
                      <option value="">-</option>
                      {['Ù…Ø­Ù…Ø¯','Ø£Ø­Ù…Ø¯','ÙŠØ§Ø³ÙŠÙ†'].includes(u) ? <><option value="Ù…Ø³Ø¬Ø¯">ğŸ•Œ</option><option value="ÙØ±Ø¯">ğŸ </option></> : <option value="Ø­Ø§Ø¶Ø±">âœ…</option>}
                      <option value="Ù‚Ø¶Ø§Ø¡">â³</option>
                    </select>
                  </td>
                ))}
              </tr>
            ))}
            <tr className="bg-indigo-50/50"><td colSpan="5" className="py-2 text-center text-[10px] font-black text-indigo-900 italic">Ø§Ù„Ø±ÙˆØ§ØªØ¨ ÙˆØ§Ù„Ø£Ø°ÙƒØ§Ø± (Ø§Ø¶ØºØ· Ù„Ù„Ù‚Ø±Ø§Ø¡Ø© ğŸ“–)</td></tr>
            {sunan.map(s => (
                <tr key={s}>
                    <td className="py-3 pr-2 text-[10px] font-bold text-indigo-500 cursor-pointer hover:bg-white rounded-lg transition-all" onClick={() => contentLibrary[s.split(' (')[0]] && setActiveView(s.split(' (')[0])}>
                      {s} {contentLibrary[s.split(' (')[0]] && "ğŸ“–"}
                    </td>
                    {users.map(u => (
                        <td key={u} className="text-center">
                            <button onClick={() => update(u, s, !data[date]?.[u]?.[s])} className={`w-8 h-8 rounded-xl flex items-center justify-center border shadow-sm transition-all ${data[date]?.[u]?.[s] ? 'bg-indigo-600 text-white border-indigo-700' : 'bg-white text-slate-200'}`}>
                                {data[date]?.[u]?.[s] ? "ğŸ’" : "â—‹"}
                            </button>
                        </td>
                    ))}
                </tr>
            ))}
          </tbody>
        </table>
      </div>

      {/* Ø§Ù„Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠ */}
      <div className="neu-card">
        <h3 className="font-black mb-4 text-indigo-900 text-sm">Ù…ÙØ¬Ù’Ù„ÙØ³Ù Ø§Ù„ØªÙ‘ÙØ´Ù’Ø¬ÙÙŠØ¹Ù ğŸ’¬</h3>
        <div className="neu-inset p-3 h-40 overflow-y-auto mb-4 bg-white/50">
          {messages.map((m, i) => (
            <div key={i} className={`mb-3 p-2 rounded-2xl text-xs shadow-sm ${m.user === currentUser ? 'bg-indigo-100 mr-8 text-right' : 'bg-white ml-8'}`}>
              <span className="font-black text-[8px] text-indigo-400 block mb-1">{m.user}</span>
              <p className="text-slate-800">{m.text}</p>
            </div>
          ))}
        </div>
        <div className="flex gap-2">
          <select value={currentUser} onChange={e => setCurrentUser(e.target.value)} className="w-1/4 neu-btn text-[10px] font-black bg-white rounded-xl p-2 shadow-sm border">
            {users.map(u => <option key={u} value={u}>{u}</option>)}
          </select>
          <input value={newMsg} onChange={e => setNewMsg(e.target.value)} onKeyPress={e => e.key === 'Enter' && sendChat()} placeholder="ÙƒÙ„Ù…Ø© Ø·ÙŠØ¨Ø© Ù„Ø£Ù‡Ù„Ùƒ..." className="flex-1 neu-inset px-4 text-xs outline-none py-2"/>
          <button onClick={sendChat} className="p-3 bg-indigo-900 text-white rounded-xl shadow-lg">ğŸš€</button>
        </div>
      </div>
    </div>
  );
}

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<App />);
</script>
</body>
</html>
